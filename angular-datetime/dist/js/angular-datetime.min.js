angular.module("ngDatetime",[]).factory("dateTimeFactory",[function(){var t={};return t._checkDateValid=function(t){return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())},t.newDate=function(t){if(""===t||null===t)throw new Error("时间为空时，不允许格式化");if(angular.isNumber(Number(t))&&!angular.equals(NaN,Number(t)))try{return new Date(Number(t))}catch(e){}var r=t.split(" "),a=r[0].split("-");if(r[1]){var n=r[1].split(":");return new Date(a[0],a[1]-1,a[2],n[0],n[1],n[2])}return new Date(a[0],a[1]-1,a[2])},t.format=function(t,e){if(!this._checkDateValid(t))return"-";var t=t,r={"m+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"i+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in r)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?r[a]:("00"+r[a]).substr((""+r[a]).length)));return e},t.getDate=function(t,e){var r=angular.copy(t);return r.setDate(r.getDate()+e),r},t.getPreMonth=function(t){t=this.format(t,"yyyy-mm-dd");var e=t.split("-"),r=e[0],a=e[1],n=e[2],u=new Date(r,a,0);u=u.getDate();var i=r,g=parseInt(a)-1;0==g&&(i=parseInt(i)-1,g=12);var o=n,s=new Date(i,g,0);s=s.getDate(),o>s&&(o=s),g<10&&(g="0"+g);var l=i+"-"+g+"-"+o;return l},t.getNextMonth=function(t){t=this.format(t,"yyyy-mm-dd");var e=t.split("-"),r=e[0],a=e[1],n=e[2],u=new Date(r,a,0);u=u.getDate();var i=r,g=parseInt(a)+1;13==g&&(i=parseInt(i)+1,g=1);var o=n,s=new Date(i,g,0);s=s.getDate(),o>s&&(o=s),g<10&&(g="0"+g);var l=i+"-"+g+"-"+o;return l},t}]);